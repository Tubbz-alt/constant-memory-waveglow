# WaveGlow

Another PyTorch implementation of [WaveGlow: A Flow-based Generative Network for Speech Synthesis](https://arxiv.org/abs/1811.00002).

Most of the codes are based on NVIDIA [official implementation](https://github.com/NVIDIA/waveglow), and the project structure 
is brought from [pytorch-template](https://github.com/victoresque/pytorch-template).

## Quick Start

Modify the `data_dir` in the json file to a directory which has a bunch of wave files with the same sampling rate, 
then your are good to go. The mel-spectrogram will be computed on the fly.

```json
{
  "data_loader": {
    "type": "RandomWaveFileLoader",
    "args": {
      "data_dir": "/your/data/wave/files",
      "batch_size": 8,
      "num_workers": 2,
      "segment": 16000
    }
  }
}
```

```
python train.py -c config.json
```

## Issues

I haven't succedd to train the model because of 2 issues:

1. After thousands of steps, when the nll loss is around -6~-7, it will start to go crazy, leading to a unstable training state.
At this time the audio generated by the model will be very noisy, like it just collapse.
2. The loss value has a huge probability to become `nan`.

If anyone find the cause of these problems, please open an issue and I will fix it a soon as possible.